<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AerialVision Ops Console</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <div class="bg-grid"></div>

    <header class="topbar">
        <div class="brand">
            <h1>AerialVision</h1>
            <p>Urban Mobility Intelligence Console</p>
        </div>
        <div class="topbar-actions">
            <label class="api-field" for="apiBaseInput">
                API Base
                <input id="apiBaseInput" type="text" value="http://localhost:8000">
            </label>
            <button class="btn btn-secondary" id="applyApiBaseBtn">Apply</button>
        </div>
    </header>

    <main class="layout">
        <section class="panel panel-hero">
            <div class="hero-copy">
                <p class="eyebrow">Real-Time Decision Support</p>
                <h2>From aerial frame to congestion signal in milliseconds.</h2>
                <p class="muted">Analyze traffic density, vehicle mix, and hotspot movement with model-backed inference and operator-friendly visual analytics.</p>
            </div>
            <div class="hero-kpis">
                <article>
                    <span id="kpiVehicles">0</span>
                    <p>Vehicles</p>
                </article>
                <article>
                    <span id="kpiDensity">0</span>
                    <p>Density / MPX</p>
                </article>
                <article>
                    <span id="kpiCongestion">LOW</span>
                    <p>Congestion</p>
                </article>
            </div>
        </section>

        <section class="panel panel-control">
            <h3>Detection Pipeline</h3>
            <div class="upload-area" id="uploadArea">
                <input type="file" id="fileInput" accept="image/*,video/*" hidden>
                <p class="upload-title">Drop aerial image/video or click to select</p>
                <p id="fileMeta" class="muted">No file selected</p>
            </div>

            <div class="controls-grid">
                <label>
                    Confidence: <strong id="confValue">0.50</strong>
                    <input type="range" id="confSlider" min="0.1" max="0.95" step="0.05" value="0.5">
                </label>
                <label>
                    IoU: <strong id="iouValue">0.45</strong>
                    <input type="range" id="iouSlider" min="0.1" max="0.95" step="0.05" value="0.45">
                </label>
            </div>

            <div class="btn-row">
                <button class="btn btn-primary" id="detectBtn" disabled>Run Detection</button>
                <button class="btn btn-secondary" id="trackBtn" disabled>Run Video Tracking</button>
                <button class="btn btn-danger" id="downloadReportBtn" disabled>Export JSON Report</button>
            </div>
            <p id="statusText" class="status-text"></p>
        </section>

        <section class="panel panel-results" id="resultsPanel">
            <h3>Inference Output</h3>
            <div class="metrics-grid">
                <article><span>Total</span><strong id="totalVehicles">0</strong></article>
                <article><span>Cars + Vans</span><strong id="carCount">0</strong></article>
                <article><span>Truck + Bus</span><strong id="truckCount">0</strong></article>
                <article><span>Inference</span><strong id="inferenceTime">0 ms</strong></article>
                <article><span>Avg Confidence</span><strong id="avgConf">0%</strong></article>
                <article><span>Heavy Ratio</span><strong id="heavyRatio">0%</strong></article>
            </div>
            <div class="result-image">
                <img id="resultImg" src="" alt="Detection output">
            </div>
            <div class="detections-wrap">
                <h4>Top Detections</h4>
                <div id="detectionsList"></div>
            </div>
        </section>

        <section class="panel panel-insights">
            <h3>Spatial Hotspots</h3>
            <div class="hotspot-grid">
                <div><span>Top Left</span><strong id="hsTopLeft">0</strong></div>
                <div><span>Top Right</span><strong id="hsTopRight">0</strong></div>
                <div><span>Bottom Left</span><strong id="hsBottomLeft">0</strong></div>
                <div><span>Bottom Right</span><strong id="hsBottomRight">0</strong></div>
            </div>
            <h3 class="history-title">Recent Inference History</h3>
            <canvas id="historyCanvas" width="800" height="220"></canvas>
        </section>

        <section class="panel panel-stream">
            <h3>Live Stream Analyzer</h3>
            <video id="videoStream" class="video-player" autoplay muted playsinline></video>
            <div class="btn-row">
                <button class="btn btn-secondary" id="startStreamBtn">Start Camera</button>
                <button class="btn btn-danger" id="stopStreamBtn" disabled>Stop Camera</button>
            </div>
            <div class="stream-stats" id="streamStats" hidden>
                <article><span>FPS</span><strong id="fps">0</strong></article>
                <article><span>Vehicles</span><strong id="streamVehicles">0</strong></article>
                <article><span>Congestion</span><strong id="streamCongestion">LOW</strong></article>
            </div>
        </section>
    </main>

    <script src="/static/script.js"></script>
</body>
</html>
